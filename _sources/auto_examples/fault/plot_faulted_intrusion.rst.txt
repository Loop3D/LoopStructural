.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_fault_plot_faulted_intrusion.py>`     to download the full example code
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_fault_plot_faulted_intrusion.py:


Modelling faults using structural frames
========================================



.. code-block:: default


    from LoopStructural import GeologicalModel
    from LoopStructural.visualisation import LavaVuModelViewer
    from LoopStructural.datasets import load_intrusion
    import pandas as pd 
    import numpy as np
    import matplotlib.pyplot as plt

    data, bb = load_intrusion()









Modelling faults using structural frames
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Standard implicit modelling techniques either treat faults as domain
boundaries or use a step function in the implicit function to capture
the displacement in the faulted surface.

Adding faults into the implicit function using step functions is limited
because this does not capture the kinematics of the fault. It
effectively defines the fault displacement by adding a value to the
scalar field on the hanging wall of the fault. In the example below a
2-D ellipsoidal function is combined with a step function to show how
the resulting geometry results in a shrinking shape. This would be
representative of modelling an intrusion.



.. code-block:: default


    intrusion = lambda x,y: (x*2)**2+(y**2)
    x = np.linspace(-10,10,100)
    y = np.linspace(-10,10,100)
    xx, yy = np.meshgrid(x,y)
    fault = np.zeros(xx.shape)
    fault[yy>0] = 50
    val = intrusion(xx,yy)+fault


    plt.contourf(val)





.. image:: /auto_examples/fault/images/sphx_glr_plot_faulted_intrusion_001.png
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    <matplotlib.contour.QuadContourSet object at 0x7fe404bef128>



LoopStructural applies structural frames to the fault geometry to
capture the geometry and kinematics of the fault. A fault frame
consisting of the fault surface, fault slip direction and fault extent
are built from observations. The geometry of the deformed surface is
then interpolated by first restoring the observations by combining the
fault frame and an expected displacement model.



.. code-block:: default


    model = GeologicalModel(bb[0,:],bb[1,:])
    model.set_model_data(data)
    fault = model.create_and_add_fault('fault',
                                       500,
                                       nelements=10000,
                                       steps=4,
                                       interpolatortype='PLI',
                                      buffer=0.3)

    viewer = LavaVuModelViewer(model)
    viewer.add_isosurface(fault['feature'],
                         voxet=model.voxet(),
                          isovalue=0
    #                       slices=[0,1]#nslices=10
                         )
    xyz = model.data[model.data['type']=='strati'][['X','Y','Z']].to_numpy()
    xyz = xyz[fault['feature'].evaluate(xyz),:]
    viewer.add_vector_field(fault['feature'], locations= xyz)
    viewer.add_points(model.data[model.data['type']=='strati'][['X','Y','Z']],name='prefault')
    viewer.display()



    displacement = 400#INSERT YOUR DISPLACEMENT NUMBER HERE BEFORE #

    model = GeologicalModel(bb[0,:],bb[1,:])
    model.set_model_data(data)
    fault = model.create_and_add_fault('fault',
                                       displacement,
                                       nelements=2000,
                                       steps=4,
                                       interpolatortype='PLI',
                                      buffer=0.3)
    strati = model.create_and_add_foliation('strati',nelements=30000,interpolatortype='PLI',cgw=0.03)

    viewer = LavaVuModelViewer(model)
    viewer.add_isosurface(strati['feature'],
                         voxet=model.voxet(),
                         isovalue=0)
    # viewer.add_data(model.features[0][0])
    viewer.add_data(strati['feature'])
    viewer.add_isosurface(fault['feature'],isovalue=0
    #                       slices=[0,1]#nslices=10
                         )
    viewer.add_points(model.data[model.data['type']=='strati'][['X','Y','Z']],name='prefault')
    viewer.display()




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/fault/images/sphx_glr_plot_faulted_intrusion_002.png
            :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/fault/images/sphx_glr_plot_faulted_intrusion_003.png
            :class: sphx-glr-multi-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  20.728 seconds)


.. _sphx_glr_download_auto_examples_fault_plot_faulted_intrusion.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_faulted_intrusion.py <plot_faulted_intrusion.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_faulted_intrusion.ipynb <plot_faulted_intrusion.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
