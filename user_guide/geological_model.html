
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Geological Model &#8212; LoopStructural 1.6.23 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=025bf93f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/geological_model';</script>
    <script src="../_static/custom-icon.js?v=40bda21d"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Implicit Interpolators" href="interpolation_options.html" />
    <link rel="prev" title="Input data" href="input_data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
    <meta name="docbuild:last-update" content="Nov 05, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/infinity_loop_icon.svg" class="logo__image only-light" alt=""/>
    <img src="../_static/infinity_loop_icon.svg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">LoopStructural - 1.6.23</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../_auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../API.html">
    API
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://www.loop3d.org">
    Loop3d
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/loop3d" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/loop3d/LoopStructural" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/LoopStructural" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../_auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../API.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.loop3d.org">
    Loop3d
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/loop3d" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/loop3d/LoopStructural" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/LoopStructural" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="what_is_a_geological_model.html">Implicit Geological Modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_data.html">Input data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Geological Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation_options.html">Implicit Interpolators</a></li>
<li class="toctree-l1"><a class="reference internal" href="fold_modelling.html">Fold modelling</a></li>
<li class="toctree-l1"><a class="reference internal" href="fault_modelling.html">Fault modelling</a></li>

<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Visualisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging LoopStructural</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Geological Model</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="geological-model">
<h1>Geological Model<a class="headerlink" href="#geological-model" title="Link to this heading">#</a></h1>
<p>The GeologicalModel is the main entry point for creating a LoopStructural model.
GeologicalModel’s define the bounding box of the model, determine how the different scalar fields interact and apply the time aware modelling.</p>
<section id="creating-a-model-manually">
<h2>Creating a model manually<a class="headerlink" href="#creating-a-model-manually" title="Link to this heading">#</a></h2>
<p>A GeologicalModel can be created using the default constructor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">GeologicalModel</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span><span class="n">maximum</span><span class="p">)</span>
</pre></div>
</div>
<p>Additional arguments that can be provided are:</p>
<blockquote>
<div><div class="pst-scrollable-table-container"><table class="table" id="id1">
<caption><span class="caption-text">Finite Difference Interpolator (FDI)</span><a class="headerlink" href="#id1" title="Link to this table">#</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>rescale</p></td>
<td><p>Boolean (True), whether to rescale the model so between 0,1</p></td>
</tr>
<tr class="row-odd"><td><p>nsteps</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>reuse_supports</p></td>
<td><p>Boolean (False), whether to reuse the inteprolation supports for similar objects</p></td>
</tr>
<tr class="row-odd"><td><p>logfile</p></td>
<td><p>String (None), file to store the loopstructural log to</p></td>
</tr>
<tr class="row-even"><td><p>loglevel</p></td>
<td><p>logging level to use (‘info’), ‘warn’,’error’,’debug’</p></td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<p>A dataset then needs to be added to the model, the data set is a pandas dataframe.
Within this method the data will be rescaled to the model coordinates.
The dataframe will be checked to make sure the correct columns exists.
The model creates a copy of the dataframe meaning that the original data frame is not modified.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">set_model_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<section id="adding-a-geological-feature">
<h3>Adding a geological feature<a class="headerlink" href="#adding-a-geological-feature" title="Link to this heading">#</a></h3>
<p>Once the model has been initialised and the data has been linked to the model,
we can add a geological feature to the model.
There are a number of different methods that can be used to add a geological feature
to the model.</p>
</section>
<section id="adding-a-foliation">
<h3>Adding a foliation<a class="headerlink" href="#adding-a-foliation" title="Link to this heading">#</a></h3>
<p>We can add a foliation to the model using the <em>create_and_add_foliation</em> method for a GeologicalModel object.
The only required argument is the feature_name, which is the identifier to the datasets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_foliation</span><span class="p">(</span><span class="n">feature_name</span><span class="p">,</span>
                                <span class="n">interpolatortype</span> <span class="o">=</span> <span class="s1">&#39;PLI&#39;</span><span class="p">,</span>
                                <span class="n">nelements</span> <span class="o">=</span> <span class="mf">1e5</span><span class="p">,</span>
                                <span class="n">buffer</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
                                <span class="n">solver</span> <span class="o">=</span> <span class="s1">&#39;cg&#39;</span><span class="p">,</span>
                                <span class="n">damp</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The other parameters are used to tune the behaviour of LoopStructural.
Different interpolation schemes can be used, see <a class="reference internal" href="interpolation_options.html"><span class="doc">Implicit Interpolators</span></a> for more information.</p>
</section>
<section id="adding-a-fault">
<h3>Adding a fault<a class="headerlink" href="#adding-a-fault" title="Link to this heading">#</a></h3>
<p>Faults are modelled by building a structural frame to define the fault geometry.
The structural frame has three coordinates:</p>
<ul class="simple">
<li><p>Coordinate 0: Fault surface</p></li>
<li><p>Coordinate 1: Fault slip direction</p></li>
<li><p>Coordinate 2: Fault extent</p></li>
</ul>
<p>Observations can be linked to particular features using the <em>coord</em> column in the data frame.</p>
<p>When the fault is modelled the fault surface is defined by the 0 isosurface of the scalar field.
The positive values of the scalar field represent the hanging wall of the fault and the negative values the footwall.</p>
<p>The displacement of the fault can be provided as either a constant displacement for the hanging wall, or a function of
the fault frame coordinates scaled by the maximum displacement.</p>
<p>The fault can be modelled with either a constant displacement on the hanging wall.</p>
<ul class="simple">
<li><p>displacement magnitude or displacement function</p></li>
<li><p>fault surface is isovalue of 0 for scalar field</p></li>
<li><p>fault is incorporated by restoring the model area and data points</p></li>
<li><p>fault needs to be given slip direction</p></li>
<li><p>fault extent is estimated to be the map expression of the fault if no data is given</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_fault</span><span class="p">(</span><span class="n">feature_name</span><span class="p">,</span> <span class="n">displacement</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-an-uncomformity">
<h3>Adding an uncomformity<a class="headerlink" href="#adding-an-uncomformity" title="Link to this heading">#</a></h3>
<p>There are two ways an unconformity can be added into the model.
The first approach creates an unconformity as a new geological feature assigning the unconformity surface to the 0 isovalue.
Using this approach does not ensure that the unconformity is conformable to a stratigraphic series.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">create_and_add_unconformity</span><span class="p">(</span><span class="n">feature_name</span><span class="p">)</span>
</pre></div>
</div>
<p>The second approach uses an existing GeologicalFeature and definies a specific value of this scalar field to represent the unconformity.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add_unconformity</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>The unconformity acts as a mask clipping any older stratigraphic units by the geometry of the unconformity.</p>
<p>Onlap unconformities can be added in the same way using the</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">add_onlap_unconformity</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>This will clip any younger stratigraphic units to be clipped by the value of the unconformity.</p>
</section>
</section>
<section id="setting-a-stratigraphic-column">
<h2>Setting a stratigraphic column<a class="headerlink" href="#setting-a-stratigraphic-column" title="Link to this heading">#</a></h2>
<p>The GeologicalModel can have a stratigraphic column assigned to it.
The stratigraphic column performs a map between the GeologicalFeatures representing stratigraphy and a unique identification for each stratigraphic unit.
The stratigraphic column can also be used to specify colouring for faults.</p>
<p>The stratigraphic column is a dictionary and has the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stratrigraphic</span> <span class="n">column</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="c1">#must be the GeologicalFeature name</span>
            <span class="p">{</span><span class="s1">&#39;series1&#39;</span><span class="p">:</span> <span class="c1"># name that will appear on legend</span>
                        <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mf">10.</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;colour&#39;</span><span class="p">:}</span>
            <span class="p">}</span>
    <span class="p">}</span>
<span class="n">model</span><span class="o">.</span><span class="n">set_stratigraphic_column</span><span class="p">(</span><span class="n">stratigraphic_column</span><span class="p">)</span>
</pre></div>
</div>
<p>When used to evaluate the block model or to evaluate the model surfaces the name of the first entry in the dictionary is checked for whether it contains fault.
If it is a fault, this scalar field is not used for evaluating the stratigraphy.</p>
</section>
<section id="using-the-geologicalmodel">
<h2>Using the GeologicalModel<a class="headerlink" href="#using-the-geologicalmodel" title="Link to this heading">#</a></h2>
<p>The GeologicalModel has a number of helper functions allowing you to easily access different
aspects of the model.</p>
<p>A regular grid inside the model bounding box can be retrieved:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">regular_grid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">regular_grid</span><span class="p">(</span><span class="n">nsteps</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">25</span><span class="p">),</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The parameters nsteps define how many points in x, y and z.
Shuffle defines whether the points should be ordered by axis or random (note this is useful when visualising vector data)
as regular sampling becomes obvious when slicing numpy arrays.
The rescale parameter defines whether the returned points should be in model coordinates or real world coordinates, it is
in model coordinates by default.</p>
<p>A GeologicalFeature can be extracted from the model either by name</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myfeature</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_and_add_feature</span><span class="p">(</span><span class="s1">&#39;myfeature&#39;</span><span class="p">)</span>
<span class="n">myfeature_also</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="s1">&#39;myfeature&#39;</span><span class="p">]</span>
<span class="n">myfeature_by_index</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">myfeature_by_name</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_feature_by_name</span><span class="p">(</span><span class="s1">&#39;myfeature&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="solving-updating-a-geological-model">
<h3>Solving/Updating a geological model<a class="headerlink" href="#solving-updating-a-geological-model" title="Link to this heading">#</a></h3>
<p>In version 1.1+ the implicit function representing a geological feature does not have to be solved to generate the model object.
The scalar field is solved on demand when the geological features are evaluated.
This means that parts of the geological model can be modified and only the older (features lower in the feature list) are updated.
All features in the model can be updated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>This will solve the implicit function for all features in the model and provide a progress bar.
The verbose flag provides additional information useful for debugging including the number of degrees of freedom in the system and the time taken to solve.</p>
</section>
<section id="evaluating-a-scalar-field">
<h3>Evaluating a scalar field<a class="headerlink" href="#evaluating-a-scalar-field" title="Link to this heading">#</a></h3>
<p>The scalar field for a GeologicalFeature can be evaluated using the evaluate_feature_value method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">regular_grid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">regular_grid</span><span class="p">(</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">rescale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate_feature_value</span><span class="p">(</span><span class="s1">&#39;myfeature&#39;</span><span class="p">,</span><span class="n">regular_grid</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The scale parameter determines whether the points are in model coordinates or real world.
In this example, the points were returned in real world and therefore need scaling before evaluating in
the model.
A numpy array of N dimensions will be returned where N is the number of points.
If the value cannot be evaulated it will be np.nan.</p>
</section>
<section id="evaluating-scalar-field-gradient">
<h3>Evaluating scalar field gradient<a class="headerlink" href="#evaluating-scalar-field-gradient" title="Link to this heading">#</a></h3>
<p>The gradient scalar field for a GeologicalFeature can be evaluated using the evaluate_feature_gradient method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">regular_grid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">regular_grid</span><span class="p">(</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">vf</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate_feature_gradient</span><span class="p">(</span><span class="s1">&#39;myfeature&#39;</span><span class="p">,</span><span class="n">regular_grid</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="evaluating-fault-displacement-magnitude">
<h3>Evaluating fault displacement magnitude<a class="headerlink" href="#evaluating-fault-displacement-magnitude" title="Link to this heading">#</a></h3>
<p>The fault displacement magnitude can be evaulated on a pointset.
This will evaluate the fault function for every fault in the model and can be used
for analysing models.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">regular_grid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">regular_grid</span><span class="p">(</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fault_displacement</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate_fault_displacements</span><span class="p">(</span><span class="s1">&#39;myfeature&#39;</span><span class="p">,</span><span class="n">regular_grid</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="evaluating-lithology-id">
<h3>Evaluating lithology id<a class="headerlink" href="#evaluating-lithology-id" title="Link to this heading">#</a></h3>
<p>The model can be evaluated for the lithology id defined in the stratigraphic column.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">regular_grid</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">regular_grid</span><span class="p">(</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">rescale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">litho</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate_model</span><span class="p">(</span><span class="s1">&#39;myfeature&#39;</span><span class="p">,</span><span class="n">regular_grid</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="input_data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Input data</p>
      </div>
    </a>
    <a class="right-next"
       href="interpolation_options.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Implicit Interpolators</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-model-manually">Creating a model manually</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-geological-feature">Adding a geological feature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-foliation">Adding a foliation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-a-fault">Adding a fault</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-an-uncomformity">Adding an uncomformity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-a-stratigraphic-column">Setting a stratigraphic column</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-geologicalmodel">Using the GeologicalModel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-updating-a-geological-model">Solving/Updating a geological model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-a-scalar-field">Evaluating a scalar field</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-scalar-field-gradient">Evaluating scalar field gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-fault-displacement-magnitude">Evaluating fault displacement magnitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-lithology-id">Evaluating lithology id</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user_guide/geological_model.rst"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>