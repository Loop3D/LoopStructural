

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Faulted folds &mdash; LoopStructural 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modelling folds" href="folds.html" />
    <link rel="prev" title="Refolded folds" href="refolded_folds.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> LoopStructural
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Install instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Bug tracking and reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory behind LoopStructural</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API.html">LoopStructural API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="example1.html">Building an implicit surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="surfacemodelling.html">test</a></li>
<li class="toctree-l2"><a class="reference internal" href="surfacemodelling.html#implicit-surface-modelling">Implicit surface modelling</a></li>
<li class="toctree-l2"><a class="reference internal" href="faults.html">Modelling faults using structural frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="refolded_folds.html">Refolded folds</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Faulted folds</a></li>
<li class="toctree-l2"><a class="reference internal" href="#faulted-refolded-folds">Faulted refolded folds</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#imports">Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-data-and-define-model-box">Load data and define model box</a></li>
<li class="toctree-l3"><a class="reference internal" href="#view-the-data">View the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-the-model">Setting up the model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-the-fault-frame">Creating the fault frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-the-fold-frame">Creating the fold frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpolating-bedding">Interpolating bedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fold-axis-rotation-angle">Fold axis rotation angle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fold-limb-rotation-angle">Fold limb rotation angle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="folds.html">Modelling folds</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilistic_faulted_folds.html">Probabilistic faulted folds</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilistic_folds.html">Probabilistic folds</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilistic_faults.html">Probabilistic faults</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LoopStructural</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>Faulted folds</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/auto_examples/faulted_fold.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-faulted-fold-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="faulted-folds">
<span id="sphx-glr-auto-examples-faulted-fold-py"></span><h1>Faulted folds<a class="headerlink" href="#faulted-folds" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="faulted-refolded-folds">
<h1>Faulted refolded folds<a class="headerlink" href="#faulted-refolded-folds" title="Permalink to this headline">¶</a></h1>
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># adjust some settings for matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">scipy.fftpack</span>
<span class="kn">from</span> <span class="nn">LoopStructural.visualisation</span> <span class="kn">import</span> <span class="n">LavaVuModelViewer</span>
<span class="kn">from</span> <span class="nn">LoopStructural.utils.helper</span> <span class="kn">import</span> <span class="n">strike_dip_vector</span>
<span class="kn">from</span> <span class="nn">LoopStructural</span> <span class="kn">import</span> <span class="n">GeologicalModel</span>
<span class="kn">import</span> <span class="nn">LoopStructural</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># print rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="c1"># determine path of repository to set paths corretly below</span>
<span class="n">repo_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s1">&#39;../..&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">repo_path</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pynoddy.history</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="load-data-and-define-model-box">
<h2>Load data and define model box<a class="headerlink" href="#load-data-and-define-model-box" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;faulted_type1.csv&#39;</span><span class="p">)</span>
<span class="n">bb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span><span class="p">(</span><span class="mf">10000.0</span><span class="p">,</span> <span class="mf">7000.0</span><span class="p">,</span> <span class="mf">5000.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="view-the-data">
<h2>View the data<a class="headerlink" href="#view-the-data" title="Permalink to this headline">¶</a></h2>
<p>Have a look at the contents of the data frame, we can see there are a
number of columns e.g strike, dip, value, coord, type etc. These are
used by LoopStructural to constrain the interpolator. The column type
contains our identifier for which scalar field the data points are
constraining e.g. the fault, s1 or s0.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>

<span class="n">df2</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-up-the-model">
<h2>Setting up the model<a class="headerlink" href="#setting-up-the-model" title="Permalink to this headline">¶</a></h2>
<p>Below we can set up the model, first we need to know which order these
geological features occured. In this example the fault is the most
recent feature, and then the s1 foliation and then the primary foliation
(s0).</p>
<p>Therefore to create the model we add these features in the reverse
order: 1. Fault 2. s1 3. s0</p>
</div>
<div class="section" id="creating-the-fault-frame">
<h2>Creating the fault frame<a class="headerlink" href="#creating-the-fault-frame" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">GeologicalModel</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
<span class="n">model</span><span class="o">.</span><span class="n">set_model_data</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">data</span>

<span class="n">fault</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_and_add_fault</span><span class="p">(</span><span class="s1">&#39;fault&#39;</span><span class="p">,</span>
                                   <span class="o">-</span><span class="mi">500</span><span class="p">,</span>
                                   <span class="n">nelements</span><span class="o">=</span><span class="mf">2e4</span><span class="p">,</span>
                                   <span class="n">interpolatottype</span><span class="o">=</span><span class="s1">&#39;PLI&#39;</span><span class="p">,</span>
                                   <span class="n">buffer</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                   <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lu&#39;</span><span class="p">,</span>
                                   <span class="n">damp</span><span class="o">=</span><span class="kc">True</span>
                                  <span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">LavaVuModelViewer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span><span class="p">(</span><span class="n">fault</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                     <span class="n">isovalue</span><span class="o">=</span><span class="mi">0</span>
                     <span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_vector_field</span><span class="p">(</span><span class="n">fault</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">locations</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">regular_grid</span><span class="p">()[::</span><span class="mi">50</span><span class="p">])</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-the-fold-frame">
<h2>Creating the fold frame<a class="headerlink" href="#creating-the-fold-frame" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fold_frame</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_and_add_fold_frame</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span>
                                <span class="n">nelements</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span>
                                            <span class="n">regularisation</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="n">interpolatortype</span><span class="o">=</span><span class="s1">&#39;PLI&#39;</span><span class="p">,</span>
<span class="c1">#                                             gxxgy=0.,</span>
                                            <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lu&#39;</span><span class="p">,</span>
                                            <span class="n">damp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                            <span class="n">buffer</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">viewer</span> <span class="o">=</span> <span class="n">LavaVuModelViewer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span><span class="p">(</span><span class="n">fault</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                     <span class="n">isovalue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span><span class="p">(</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                     <span class="n">isovalue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="interpolating-bedding">
<h2>Interpolating bedding<a class="headerlink" href="#interpolating-bedding" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s0</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_and_add_folded_foliation</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span>
                                           <span class="n">fold_frame</span><span class="o">=</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">],</span>
                                      <span class="n">nelements</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span>
                                          <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lu&#39;</span><span class="p">,</span>
                                          <span class="n">buffer</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                          <span class="n">damp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">viewer</span> <span class="o">=</span> <span class="n">LavaVuModelViewer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">viewer</span><span class="o">.</span><span class="n">add_vector_field</span><span class="p">(</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">locations</span><span class="o">=</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">interpolator</span><span class="o">.</span><span class="n">get_gradient_constraints</span><span class="p">()[:,:</span><span class="mi">3</span><span class="p">]</span>
                       <span class="p">)</span>


<span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span><span class="p">(</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                     <span class="n">isovalue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">viewer</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

<span class="n">viewer</span><span class="o">.</span><span class="n">add_scalar_field</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab20&#39;</span><span class="p">)</span>

<span class="n">viewer</span><span class="o">.</span><span class="n">add_isosurface</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">])</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">])</span>
<span class="n">viewer</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

<span class="n">viewer</span><span class="o">.</span><span class="n">lv</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s1">&#39;images\example5.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="fold-axis-rotation-angle">
<h2>Fold axis rotation angle<a class="headerlink" href="#fold-axis-rotation-angle" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;axis_direction&#39;</span><span class="p">],</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;axis_rotation&#39;</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s0</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fold_axis_rotation</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fold axis rotation angle&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fold frame coordinate 1 value&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;axis_svariogram&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;axis_svariogram&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">variogram</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fold axis variogram&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;S-Variogram lags&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="fold-limb-rotation-angle">
<h2>Fold limb rotation angle<a class="headerlink" href="#fold-limb-rotation-angle" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">fold_frame</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;foliation&#39;</span><span class="p">],</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;limb_rotation&#39;</span><span class="p">],</span><span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s0</span><span class="p">[</span><span class="s1">&#39;fold&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fold_limb_rotation</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fold axis rotation angle&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fold frame coordinate 1 value&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;limb_svariogram&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;limb_svariogram&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">variogram</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fold axis variogram&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;S-Variogram lags&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">LoopStructural.visualisation</span> <span class="kn">import</span> <span class="n">MapView</span>
<span class="n">mapview</span> <span class="o">=</span> <span class="n">MapView</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">mapview</span><span class="o">.</span><span class="n">nsteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">])</span>
<span class="n">mapview</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">],</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
<span class="n">mapview</span><span class="o">.</span><span class="n">add_scalar_field</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab20&#39;</span><span class="p">)</span>
<span class="n">mapview</span><span class="o">.</span><span class="n">add_contour</span><span class="p">(</span><span class="n">s0</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">],</span><span class="mi">4</span><span class="p">)</span>
<span class="n">mapview</span><span class="o">.</span><span class="n">add_contour</span><span class="p">(</span><span class="n">fault</span><span class="p">[</span><span class="s1">&#39;feature&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">model</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">model</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-faulted-fold-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9ef92d738bd6347407b6ff54678f35b1/faulted_fold.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">faulted_fold.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ccbfbe6cf1b38c26400745a4ab2191f8/faulted_fold.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">faulted_fold.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="folds.html" class="btn btn-neutral float-right" title="Modelling folds" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="refolded_folds.html" class="btn btn-neutral float-left" title="Refolded folds" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Lachlan Grose

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>